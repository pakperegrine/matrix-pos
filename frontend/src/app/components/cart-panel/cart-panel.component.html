<div class="cart-panel">
  <div class="cart-header">
    <div class="title-block">
      <h4>Shopping Cart</h4>
      <span class="cart-subtitle" *ngIf="cart.length > 0">{{ cart.length }} item{{ cart.length === 1 ? '' : 's' }} in cart</span>
    </div>
    <button *ngIf="cart.length > 0" class="clear-btn" (click)="onClearCart()" title="Clear cart">
      ğŸ—‘ï¸
    </button>
  </div>
  
  <div *ngIf="cart.length === 0" class="empty">
    <div class="empty-icon">ğŸ›’</div>
    <div class="empty-text">Cart is empty</div>
    <div class="empty-subtext">Add items to start a sale</div>
  </div>
  
  <div class="cart-items" *ngIf="cart.length > 0" #cartItemsContainer>
    <div *ngFor="let c of (cart || []); trackBy: trackByProductId; let last = last" class="cart-item" [class.latest-item]="last">
      <div class="item-header">
        <div class="item-info">
          <div class="item-name">{{ c.product.name }}</div>
        </div>
        <button class="remove-btn" (click)="onRemoveItem(c)" title="Remove item">Ã—</button>
      </div>
      <div class="item-footer">
        <div class="qty-controls">
          <button class="qty-btn" (click)="decreaseQty(c)">âˆ’</button>
          <span class="qty-value">{{ c.qty }}</span>
          <button class="qty-btn" (click)="increaseQty(c)">+</button>
        </div>
        <div class="item-price">
          <span class="label">Price</span>
          <span class="value">{{ c.product.price | customCurrency }}</span>
        </div>
        <div class="item-total">
          <span class="label">Line Total</span>
          <span class="value">{{ (c.product.price * c.qty) | customCurrency }}</span>
        </div>
      </div>
    </div>
  </div>
  
  <div class="cart-footer" *ngIf="cart.length > 0">
    <!-- Price Breakdown -->
    <div class="subtotal-row">
      <span>Subtotal:</span>
      <span>{{ subtotal | customCurrency }}</span>
    </div>
    <div class="discount-row" *ngIf="discountAmount > 0">
      <span class="discount-text">Discount:</span>
      <span class="discount-value">-{{ discountAmount | customCurrency }}</span>
    </div>
    <div class="tax-row" *ngIf="settingsService.isTaxEnabled() && settingsService.showTaxOnReceipt()">
      <span>{{ settingsService.getTaxLabel() }} ({{ settingsService.getTaxRate() }}%):</span>
      <span>{{ taxAmount | customCurrency }}</span>
    </div>
    <hr />
    <div class="total-row">
      <strong>Total:</strong>
      <strong class="total-amount">{{ total | customCurrency }}</strong>
    </div>
    <div *ngIf="discountAmount > 0" class="savings-badge">
      ğŸ‰ You saved {{ discountAmount | customCurrency }}!
    </div>
    <button class="checkout-btn" (click)="onCheckout()">
      <span class="btn-icon">ğŸ’³</span>
      <span>Checkout</span>
    </button>
  </div>
</div>
